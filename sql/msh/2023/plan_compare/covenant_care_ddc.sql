select p.id into raw.plan_compare_patients_covenant_care
from fdw_member_doc.patients p
         join fdw_member_doc.patient_referring_partners prp on prp.patient_id = p.id
         join fdw_member_doc.referring_partners rp on rp.id = prp.referring_partner_id
where rp.id in (273, 274, 275, 276);


select
       ddc.contactid,
       ddc.memberid,
       ddc.medicareplanid,
       ddc.producttypeid,
       ddc.bidid,
       ddc.plantype,
       ddc.planname,
       ddc.network_type,
       ddc.providernumber,
       ddc.pharmacyname,
       ddc.addressline1,
       ddc.addressline2,
       ddc.cityname,
       ddc.statename,
       ddc.postalcode,
       ddc.preferredstatusretail,
       ddc.preferredstatusmail,
       ddc.pharmacyretail,
       ddc.pharmacymail,
       ddc.ndc,
       ddc.brandflag,
       ddc.drugname,
       ddc.quantitydispensed,
       ddc.quantitydispensedused,
       ddc.dayssupply,
       ddc.tier,
       ddc.tierlevelvalue,
       ddc.drugcost,
       ddc.deductibleapplies,
       ddc.deductible,
       ddc.costindeductible,
       ddc.costinicl,
       ddc.iclcopay,
       ddc.iclcoinsurance,
       ddc.costingap,
       ddc.gapcopay,
       ddc.gapcoinsurance,
       ddc.costincatastrophic,
       ddc.catastrophiccopay,
       ddc.catastrophiccoinsurance,
       ddc.priorauthorization,
       ddc.quantitylimit,
       ddc.quantitylimitamount,
       ddc.quantitylimitdays,
       ddc.steptherapy,
       ddc.annualdrugcostestimate,
       ddc.annualdeductiblephaseestimate,
       ddc.annualiclphaseestimate,
       ddc.annualgapphaseestimate,
       ddc.annualcatastrophicphaseestimate,
       ddc.monthlydrugcostestimate_jan_totalcostestimate,
       ddc.monthlydrugcostestimate_jan_deductiblecostestimate,
       ddc.monthlydrugcostestimate_jan_iclcostestimate,
       ddc.monthlydrugcostestimate_jan_gapcostestimate,
       ddc.monthlydrugcostestimate_jan_catastrophiccostestimate,
       ddc.monthlydrugcostestimate_feb_totalcostestimate,
       ddc.monthlydrugcostestimate_feb_deductiblecostestimate,
       ddc.monthlydrugcostestimate_feb_iclcostestimate,
       ddc.monthlydrugcostestimate_feb_gapcostestimate,
       ddc.monthlydrugcostestimate_feb_catastrophiccostestimate,
       ddc.monthlydrugcostestimate_mar_totalcostestimate,
       ddc.monthlydrugcostestimate_mar_deductiblecostestimate,
       ddc.monthlydrugcostestimate_mar_iclcostestimate,
       ddc.monthlydrugcostestimate_mar_gapcostestimate,
       ddc.monthlydrugcostestimate_mar_catastrophiccostestimate,
       ddc.monthlydrugcostestimate_apr_totalcostestimate,
       ddc.monthlydrugcostestimate_apr_deductiblecostestimate,
       ddc.monthlydrugcostestimate_apr_iclcostestimate,
       ddc.monthlydrugcostestimate_apr_gapcostestimate,
       ddc.monthlydrugcostestimate_apr_catastrophiccostestimate,
       ddc.monthlydrugcostestimate_may_totalcostestimate,
       ddc.monthlydrugcostestimate_may_deductiblecostestimate,
       ddc.monthlydrugcostestimate_may_iclcostestimate,
       ddc.monthlydrugcostestimate_may_gapcostestimate,
       ddc.monthlydrugcostestimate_may_catastrophiccostestimate,
       ddc.monthlydrugcostestimate_jun_totalcostestimate,
       ddc.monthlydrugcostestimate_jun_deductiblecostestimate,
       ddc.monthlydrugcostestimate_jun_iclcostestimate,
       ddc.monthlydrugcostestimate_jun_gapcostestimate,
       ddc.monthlydrugcostestimate_jun_catastrophiccostestimate,
       ddc.monthlydrugcostestimate_jul_totalcostestimate,
       ddc.monthlydrugcostestimate_jul_deductiblecostestimate,
       ddc.monthlydrugcostestimate_jul_iclcostestimate,
       ddc.monthlydrugcostestimate_jul_gapcostestimate,
       ddc.monthlydrugcostestimate_jul_catastrophiccostestimate,
       ddc.monthlydrugcostestimate_aug_totalcostestimate,
       ddc.monthlydrugcostestimate_aug_deductiblecostestimate,
       ddc.monthlydrugcostestimate_aug_iclcostestimate,
       ddc.monthlydrugcostestimate_aug_gapcostestimate,
       ddc.monthlydrugcostestimate_aug_catastrophiccostestimate,
       ddc.monthlydrugcostestimate_sept_totalcostestimate,
       ddc.monthlydrugcostestimate_sept_deductiblecostestimate,
       ddc.monthlydrugcostestimate_sept_iclcostestimate,
       ddc.monthlydrugcostestimate_sept_gapcostestimate,
       ddc.monthlydrugcostestimate_sept_catastrophiccostestimat,
       ddc.monthlydrugcostestimate_oct_totalcostestimate,
       ddc.monthlydrugcostestimate_oct_deductiblecostestimate,
       ddc.monthlydrugcostestimate_oct_iclcostestimate,
       ddc.monthlydrugcostestimate_oct_gapcostestimate,
       ddc.monthlydrugcostestimate_oct_catastrophiccostestimate,
       ddc.monthlydrugcostestimate_nov_totalcostestimate,
       ddc.monthlydrugcostestimate_nov_deductiblecostestimate,
       ddc.monthlydrugcostestimate_nov_iclcostestimate,
       ddc.monthlydrugcostestimate_nov_gapcostestimate,
       ddc.monthlydrugcostestimate_nov_catastrophiccostestimate,
       ddc.monthlydrugcostestimate_dec_totalcostestimate,
       ddc.monthlydrugcostestimate_dec_deductiblecostestimate,
       ddc.monthlydrugcostestimate_dec_iclcostestimate,
       ddc.monthlydrugcostestimate_dec_gapcostestimate,
       ddc.monthlydrugcostestimate_dec_catastrophiccostestimate
from raw.milliman_plan_compare_detailed_drug_cost ddc
         join raw.plan_compare_patients_covenant_care pcp on pcp.id = ddc.memberid::bigint;